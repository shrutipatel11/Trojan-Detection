#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/socket.h>
#include <arpa/inet.h>
#define SA struct sockaddr

#define false            0
#define true            !false

#define NUM_X_ENTRIES   50      /* Number of entries on each axis of the */
#define NUM_Y_ENTRIES   50      /* ...2D table */
#define RAM_OUT 0

int main(int argc, const char* argv[] ){
  const int engLoadROM[] =
  {
      0, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140,
      150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260,
      270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380,
      390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500
  } ;

  const int engSpeedROM[] =
  {
      0, 200, 300, 400, 500, 600, 700, 800, 900, 1000, 1100, 1200,
      1300, 1400, 1500, 1600, 1700, 1800, 1900, 2000, 2100, 2200,
      2300, 2400, 2500, 2600, 2700, 2800, 2900, 3000, 3100, 3200,
      3300, 3400, 3500, 3600, 3700, 3800, 3900, 4000, 4100, 4200,
      4300, 4400, 4500, 4600, 4700, 4800, 4900, 5000
  } ;

  const int angleTableROM[] =
  {
      10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
      20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20,
      30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30,
      30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30,
      60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 70, 80, 90, 100, 110, 110, 110, 110, 110, 110, 110, 110, 110, 110, 110, 100, 90, 80, 70, 60, 50, 40, 39, 38, 37, 36, 35, 35, 35, 35, 35, 35, 60,
      45, 50, 50, 55, 55, 56, 56, 56, 56, 56, 56, 50, 50, 50, 50, 50, 50, 50, 60, 70, 80, 90, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 103, 90, 80, 72, 66, 60, 52, 44, 38, 32, 28, 27, 35, 35, 35, 35, 35, 60,
      30, 40, 40, 50, 54, 54, 54, 54, 54, 54, 54, 40, 40, 40, 40, 40, 40, 40, 50, 60, 70, 86, 90, 91, 92, 91, 90, 89, 89, 90, 92, 94, 94, 91, 74, 64, 63, 62, 54, 46, 40, 34, 29, 28, 35, 35, 35, 35, 35, 60,
      15, 30, 30, 40, 50, 51, 51, 51, 51, 51, 51, 30, 30, 40, 50, 60, 70, 76, 80, 86, 90, 94, 98, 99, 100, 99, 98, 97, 97, 98, 100, 102, 102, 92, 82, 72, 70, 64, 56, 48, 42, 36, 30, 29, 35, 35, 35, 35, 35, 60,
      10, 20, 20, 30, 40, 50, 50, 50, 50, 50, 50, 56, 62, 68, 74, 80, 84, 88, 92, 96, 100, 104, 108, 109, 110, 109, 108, 107, 107, 108, 110, 112, 112, 102, 92, 82, 72, 67, 59, 51, 47, 43, 41, 39, 37, 37, 37, 37, 37, 60,
      10, 20, 20, 30, 40, 50, 50, 50, 50, 50, 50, 56, 62, 68, 74, 80, 86, 92, 98, 102, 106, 110, 114, 115, 116, 115, 114, 113, 113, 114, 116, 118, 118, 108, 98, 88, 80, 70, 62, 54, 49, 45, 43, 41, 39, 39, 39, 39, 39, 100,
      12, 20, 20, 30, 40, 50, 50, 50, 50, 50, 50, 56, 62, 68, 74, 80, 86, 92, 98, 104, 108, 112, 116, 117, 118, 117, 116, 115, 115, 116, 118, 120, 120, 110, 100, 90, 80, 72, 64, 56, 52, 48, 46, 44, 42, 42, 42, 42, 42, 100,
      15, 20, 20, 30, 40, 50, 50, 50, 50, 50, 50, 56, 62, 68, 74, 80, 86, 92, 98, 104, 108, 112, 116, 117, 118, 117, 116, 115, 115, 116, 118, 120, 120, 110, 100, 90, 78, 75, 67, 59, 54, 49, 47, 45, 43, 43, 43, 43, 43, 100,
      20, 20, 20, 30, 40, 50, 50, 50, 50, 50, 50, 56, 62, 68, 74, 80, 86, 92, 98, 103, 107, 111, 115, 116, 117, 116, 115, 114, 114, 115, 117, 119, 119, 109, 99, 88, 78, 75, 67, 59, 54, 49, 47, 45, 43, 43, 43, 43, 43, 100,
      22, 22, 22, 32, 42, 52, 52, 52, 52, 52, 52, 58, 64, 70, 76, 84, 90, 96, 102, 102, 106, 110, 114, 115, 116, 115, 114, 113, 113, 114, 116, 118, 118, 108, 98, 88, 78, 75, 70, 59, 54, 49, 47, 45, 43, 43, 43, 43, 43, 100,
      24, 24, 24, 34, 44, 54, 54, 54, 54, 54, 54, 60, 66, 72, 78, 84, 90, 96, 102, 104, 108, 112, 116, 117, 118, 117, 116, 115, 115, 116, 118, 120, 120, 110, 100, 86, 86, 78, 75, 67, 59, 54, 49, 47, 44, 44, 44, 44, 44, 100,
      30, 30, 30, 40, 50, 60, 60, 60, 60, 60, 60, 66, 72, 78, 84, 90, 96, 102, 108, 112, 116, 120, 124, 125, 126, 125, 124, 123, 123, 124, 124, 122, 120, 118, 108, 88, 88, 78, 75, 67, 59, 54, 49, 47, 44, 44, 44, 44, 44, 100,
      30, 30, 30, 40, 50, 60, 60, 60, 60, 60, 60, 66, 72, 78, 84, 90, 96, 102, 116, 120, 124, 128, 132, 133, 134, 133, 132, 131, 131, 132, 130, 127, 124, 121, 116, 92, 92, 76, 68, 60, 56, 52, 50, 48, 46, 46, 46, 46, 46, 100,
      30, 30, 30, 40, 50, 60, 60, 60, 60, 60, 60, 66, 72, 78, 84, 90, 96, 104, 118, 122, 126, 130, 134, 135, 136, 135, 134, 133, 133, 133, 131, 128, 107, 106, 104, 92, 92, 76, 68, 60, 56, 52, 50, 48, 46, 46, 46, 46, 46, 100,
      31, 31, 31, 41, 51, 61, 61, 61, 61, 61, 61, 67, 73, 79, 85, 91, 97, 103, 120, 124, 128, 132, 136, 137, 138, 137, 136, 135, 134, 134, 132, 129, 107, 106, 104, 92, 92, 76, 68, 60, 56, 52, 50, 48, 46, 46, 46, 46, 46, 100,
      33, 33, 33, 43, 53, 63, 63, 63, 63, 63, 63, 69, 75, 81, 87, 93, 99, 105, 122, 126, 130, 134, 138, 139, 140, 139, 138, 137, 135, 135, 133, 130, 108, 107, 104, 94, 94, 77, 72, 66, 60, 72, 75, 70, 66, 66, 66, 66, 66, 100,
      35, 35, 35, 45, 55, 65, 65, 65, 65, 65, 65, 71, 77, 83, 88, 96, 100, 107, 124, 128, 132, 136, 140, 141, 142, 141, 140, 139, 136, 136, 134, 131, 108, 107, 105, 94, 94, 77, 76, 72, 70, 92, 100, 105, 86, 86, 86, 86, 86, 100,
      35, 35, 35, 45, 55, 65, 65, 65, 65, 65, 65, 67, 69, 71, 77, 83, 89, 95, 126, 130, 134, 138, 142, 143, 144, 143, 142, 141, 137, 137, 135, 132, 109, 108, 107, 106, 105, 105, 104, 108, 112, 116, 120, 120, 106, 106, 106, 106, 106, 100,
      35, 35, 35, 45, 55, 65, 65, 65, 65, 65, 65, 65, 65, 65, 71, 81, 91, 101, 127, 131, 135, 139, 143, 144, 145, 144, 144, 142, 138, 138, 136, 133, 131, 127, 125, 122, 120, 125, 130, 135, 140, 145, 140, 108, 116, 116, 116, 116, 116, 100,
      38, 38, 38, 48, 58, 68, 68, 68, 68, 68, 68, 68, 68, 68, 74, 84, 94, 104, 128, 132, 136, 140, 143, 145, 146, 145, 145, 143, 139, 139, 137, 134, 130, 126, 124, 126, 130, 135, 140, 145, 150, 155, 150, 140, 120, 120, 120, 120, 120, 100,
      41, 41, 41, 51, 61, 71, 71, 71, 71, 71, 71, 71, 71, 71, 77, 87, 97, 107, 129, 133, 137, 141, 143, 146, 147, 146, 146, 144, 140, 140, 138, 135, 129, 125, 123, 122, 124, 129, 134, 139, 144, 149, 139, 138, 122, 122, 122, 122, 122, 100,
      44, 44, 44, 54, 64, 74, 74, 74, 74, 74, 74, 74, 74, 74, 80, 90, 100, 110, 130, 134, 138, 142, 144, 147, 148, 147, 147, 145, 141, 141, 139, 134, 128, 124, 122, 122, 122, 127, 132, 137, 142, 147, 137, 136, 124, 124, 124, 124, 124, 100,
      47, 47, 47, 57, 67, 77, 77, 77, 77, 77, 77, 77, 77, 77, 87, 97, 107, 117, 131, 135, 139, 143, 144, 148, 149, 148, 148, 146, 142, 143, 140, 133, 127, 123, 121, 120, 121, 126, 131, 136, 141, 146, 136, 134, 126, 126, 126, 126, 126, 100,
      45, 45, 45, 55, 65, 75, 75, 75, 75, 75, 75, 75, 78, 88, 98, 108, 118, 128, 138, 142, 144, 144, 144, 149, 150, 149, 149, 145, 143, 145, 141, 132, 126, 122, 120, 119, 120, 125, 130, 135, 140, 145, 135, 132, 130, 130, 130, 130, 130, 100,
      43, 43, 43, 53, 63, 73, 73, 73, 73, 73, 73, 76, 79, 89, 109, 108, 118, 128, 138, 142, 144, 144, 144, 149, 150, 149, 149, 145, 143, 153, 142, 131, 125, 121, 120, 119, 118, 117, 116, 115, 114, 144, 139, 134, 136, 136, 136, 136, 136, 100,
      42, 42, 42, 52, 62, 72, 72, 72, 72, 72, 72, 75, 78, 88, 98, 108, 118, 128, 138, 142, 144, 144, 144, 142, 142, 138, 148, 143, 144, 142, 142, 130, 124, 124, 125, 125, 124, 123, 123, 123, 128, 143, 133, 128, 142, 142, 142, 142, 142, 100,
      41, 41, 41, 51, 61, 71, 71, 71, 71, 71, 71, 74, 77, 87, 97, 107, 117, 127, 137, 141, 143, 143, 143, 141, 141, 137, 146, 142, 133, 141, 141, 129, 123, 125, 130, 129, 128, 127, 127, 132, 137, 142, 132, 126, 148, 148, 148, 148, 148, 100,
      40, 40, 40, 50, 60, 70, 70, 70, 70, 70, 70, 73, 76, 86, 96, 106, 116, 126, 136, 140, 142, 142, 142, 140, 140, 136, 142, 141, 136, 140, 140, 139, 137, 135, 133, 131, 130, 129, 128, 132, 137, 142, 131, 125, 142, 142, 142, 142, 142, 100,
      46, 46, 46, 56, 66, 76, 76, 76, 76, 76, 76, 84, 92, 100, 108, 116, 124, 132, 140, 144, 146, 146, 146, 144, 144, 140, 140, 140, 140, 144, 140, 139, 137, 135, 133, 131, 130, 129, 128, 127, 126, 141, 131, 124, 136, 136, 136, 136, 136, 100,
      50, 50, 50, 60, 70, 80, 80, 80, 80, 80, 80, 88, 96, 104, 112, 120, 128, 136, 144, 148, 150, 150, 150, 148, 148, 144, 138, 139, 144, 148, 144, 143, 141, 139, 137, 135, 134, 133, 132, 131, 130, 141, 130, 123, 130, 130, 130, 130, 130, 100,
      54, 54, 54, 64, 74, 84, 84, 84, 84, 84, 84, 92, 100, 108, 116, 124, 132, 140, 148, 152, 154, 154, 154, 152, 152, 148, 136, 140, 148, 152, 148, 147, 145, 143, 141, 139, 138, 137, 136, 135, 134, 140, 130, 122, 126, 126, 126, 126, 126, 100,
      58, 58, 58, 68, 78, 88, 88, 88, 88, 88, 88, 96, 104, 112, 120, 128, 136, 144, 152, 156, 158, 158, 158, 156, 156, 152, 136, 144, 152, 156, 152, 151, 149, 147, 145, 143, 142, 141, 140, 139, 138, 134, 130, 121, 124, 124, 124, 124, 124, 100,
      62, 62, 62, 72, 82, 92, 92, 92, 92, 92, 92, 100, 108, 116, 124, 132, 140, 148, 156, 160, 162, 162, 162, 160, 160, 156, 140, 148, 156, 160, 156, 155, 153, 151, 149, 147, 146, 145, 144, 143, 142, 133, 129, 120, 122, 122, 122, 122, 122, 100,
      62, 62, 62, 72, 82, 92, 92, 92, 92, 92, 92, 100, 108, 116, 124, 132, 140, 148, 156, 160, 162, 162, 162, 160, 160, 156, 140, 148, 156, 160, 156, 155, 153, 151, 149, 147, 146, 145, 144, 143, 142, 132, 129, 128, 120, 120, 120, 120, 120, 100,
      62, 62, 62, 72, 82, 92, 92, 92, 92, 92, 92, 100, 108, 116, 124, 132, 140, 148, 156, 160, 162, 162, 162, 160, 160, 156, 140, 148, 156, 160, 156, 155, 153, 151, 149, 147, 146, 145, 144, 143, 142, 131, 130, 129, 123, 123, 123, 123, 123, 100,
      62, 62, 62, 72, 82, 92, 92, 92, 92, 92, 92, 100, 108, 116, 124, 132, 140, 148, 156, 160, 162, 162, 162, 160, 160, 156, 140, 148, 156, 160, 156, 155, 153, 151, 149, 147, 146, 145, 144, 143, 142, 130, 132, 131, 126, 126, 126, 126, 126, 100,
      62, 62, 62, 72, 82, 92, 92, 92, 92, 92, 92, 100, 108, 116, 124, 132, 140, 148, 156, 160, 162, 162, 162, 160, 160, 156, 140, 148, 156, 160, 156, 155, 153, 151, 149, 147, 146, 145, 144, 143, 142, 141, 134, 133, 130, 130, 130, 130, 130, 100,
      62, 62, 62, 72, 82, 92, 92, 92, 92, 92, 92, 100, 108, 116, 124, 132, 140, 148, 156, 160, 162, 162, 162, 160, 160, 156, 140, 148, 156, 160, 156, 155, 153, 151, 149, 147, 146, 145, 144, 143, 142, 141, 136, 135, 130, 130, 130, 130, 130, 100,
      62, 62, 62, 72, 82, 92, 92, 92, 92, 92, 92, 100, 108, 116, 124, 132, 140, 148, 156, 160, 162, 162, 162, 160, 160, 156, 140, 148, 156, 160, 156, 155, 153, 151, 149, 147, 146, 145, 144, 143, 142, 141, 138, 137, 130, 130, 130, 130, 130, 100,
      62, 62, 62, 72, 82, 92, 92, 92, 92, 92, 92, 100, 108, 116, 124, 132, 140, 148, 156, 160, 162, 162, 162, 160, 160, 156, 140, 148, 156, 160, 156, 155, 153, 151, 149, 147, 146, 145, 144, 143, 142, 141, 140, 139, 130, 130, 130, 130, 130, 100,
      62, 62, 62, 72, 82, 92, 92, 92, 92, 92, 92, 100, 108, 116, 124, 132, 140, 148, 156, 160, 162, 162, 162, 160, 160, 156, 140, 148, 156, 160, 156, 155, 153, 151, 149, 147, 146, 145, 144, 143, 142, 141, 140, 139, 130, 130, 130, 130, 130, 100,
      62, 62, 62, 72, 82, 92, 92, 92, 92, 92, 92, 100, 108, 116, 124, 132, 140, 148, 156, 160, 162, 162, 162, 160, 160, 156, 140, 148, 156, 160, 156, 155, 153, 151, 149, 147, 146, 145, 144, 143, 142, 141, 140, 139, 130, 130, 130, 130, 130, 100,
      62, 62, 62, 72, 82, 92, 92, 92, 92, 92, 92, 100, 108, 116, 124, 132, 140, 148, 156, 160, 162, 162, 162, 160, 160, 156, 140, 148, 156, 160, 156, 155, 153, 151, 149, 147, 146, 145, 144, 143, 142, 141, 140, 139, 130, 130, 130, 130, 130, 100,
      62, 62, 62, 72, 82, 92, 92, 92, 92, 92, 92, 100, 108, 116, 124, 132, 140, 148, 156, 160, 162, 162, 162, 160, 160, 156, 140, 148, 156, 160, 156, 155, 153, 151, 149, 147, 146, 145, 144, 143, 142, 141, 140, 139, 130, 130, 130, 130, 130, 100,
      62, 62, 62, 72, 82, 92, 92, 92, 92, 92, 92, 100, 108, 116, 124, 132, 140, 148, 156, 160, 162, 162, 162, 160, 160, 156, 140, 148, 156, 160, 156, 155, 153, 151, 149, 147, 146, 145, 144, 143, 142, 141, 140, 139, 130, 130, 130, 130, 130, 100,
      62, 62, 62, 72, 82, 92, 92, 92, 92, 92, 92, 100, 108, 116, 124, 132, 140, 148, 156, 160, 162, 162, 162, 160, 160, 156, 140, 148, 156, 160, 156, 155, 153, 151, 149, 147, 146, 145, 144, 143, 142, 141, 140, 139, 130, 130, 130, 130, 130, 100
  } ; /* End of angleTableROM[] */

  printf("Task Name : TABLE\n");
  int sockfd, connfd;
  struct sockaddr_in servaddr, cli;

  int port;
  port = atoi(argv[2]);

  sockfd = socket(AF_INET, SOCK_STREAM, 0);
  if (sockfd == -1) {
      // printf("Socket creation failed...\n");
      exit(0);
  }
  bzero(&servaddr, sizeof(servaddr));

  // assign IP, PORT
  servaddr.sin_family = AF_INET;
  servaddr.sin_addr.s_addr = inet_addr(argv[1]);
  servaddr.sin_port = htons(port);
  bzero(&(servaddr.sin_zero),8);

  // printf("Port number : %d\n",port);
  // connect the client socket to server socket
  if (connect(sockfd, (SA*)&servaddr, sizeof(servaddr)) != 0) {
      // printf("Connection with the server failed...\n");
      exit(0);
  }

  char buff[60000];
  bzero(buff, sizeof(buff));
  read(sockfd, buff, sizeof(buff));
  const int len = atoi(buff);

  int inputArray[len];
  int outputArray[len];
  int index = 0;
  for(int i=0; i<len;  i++) inputArray[i]=0;

  char full[900000];
  int ii=0;
  while(1){
    bzero(buff, sizeof(buff));
    read(sockfd, buff, sizeof(buff));
    // printf("Recived buffer len %ld \n",strlen(buff));
    if(strlen(buff)==1) break;
    for(int j=0; j<strlen(buff); j++){
      full[ii++] = buff[j];
    }
  }

  int length = strlen(full);
  int negative = 0,j=0;
  for(int i=0; i<length; i++){
    if (full[i] == ',') {
          if(negative==1){
            inputArray[j]=-1*inputArray[j];
            negative = 0;
          }
          j++;
    }
    else if(full[i] == '-'){
        negative = 1;
        continue;
    }
    else {
         inputArray[j] = inputArray[j] * 10 + (full[i] - 48);
         if(i == length-1 && negative==1) inputArray[j]=-1*inputArray[j];
    }
  }

  // printf("\nTask input received\n");
  // for(int i=0; i<len; i++) printf("%d ",inputArray[i]);
  // printf("\n\n");

  int numXEntries ;           /* The table 'x' size spec'd here */
  int numYEntries ;           /* The table 'y' size spec'd here */

  int loadValue ;             /* 'Load' pulled from test data */
  int speedValue ;            /* 'Speed' pulled from test data */

  const int *engSpeed ;       /* Linear array of 'y' axis */
  const int *engLoad ;        /* Linear array of 'x' axis */
  const int *angleTable ;     /* 2D array of f( x, y )= 'angle' */

  int i1, j1;    /* Local indices and counters */
  static int outAngleValue1 ;     /* 'Angle' pulled from map */
  static int engSpeedDelta1 ;       /* Intermediate ratios from grid */
  static int engLoadDelta1 ;

  numXEntries = NUM_X_ENTRIES ;   /* ...specify the num of table entries */
  numYEntries = NUM_Y_ENTRIES ;
  engSpeed = engSpeedROM ;        /* Point to the constant linear tables */
  engLoad = engLoadROM ;
  angleTable = angleTableROM ;

  for(int i=0; i<len; i++){
      loadValue = inputArray[i];
      speedValue = inputArray[i];

      /*  First, find the 'x' axis grid coefficients */
      for( i1 = 0 ; i1 < ( numXEntries - 1 ) ; i1++ )
          if( ( loadValue < engLoad[i1+1] ) && ( loadValue >= engLoad[i1] ) ) break ;

      if( i1 == ( numXEntries - 1 ) )  loadValue = engLoad[i1] ;
      engLoadDelta1 = (int)( loadValue - engLoad[i1] ) / (int)( engLoad[i1 + 1] - engLoad[i1] ) ;

      for( j1 = 0 ; j1 < ( numYEntries-1 ) ; j1++ )
        if( ( speedValue < engSpeed[j1+1] ) && ( speedValue >= engSpeed[j1] ) ) break ;

      if( j1 == ( numYEntries - 1 ) ) speedValue = engSpeed[j1] ;
      engSpeedDelta1 = (int)( speedValue - engSpeed[j1] ) / (int)( engSpeed[j1 + 1] - engSpeed[j1] ) ;

      outAngleValue1 = (int)(
          ( ( 1.0 - engLoadDelta1 )*( 1.0 - engSpeedDelta1 ) *
            (int)angleTable[ i1 + ( j1 * numXEntries ) ] ) +
          ( engLoadDelta1 * ( 1.0 - engSpeedDelta1 ) *
            (int)angleTable[ ( i1 + 1 ) + ( j1 * numXEntries ) ] ) +
          ( engLoadDelta1 * engSpeedDelta1 *
            (int)angleTable[ ( i1 + 1 ) + ( numXEntries * ( j1 + 1 ) ) ] ) +
          ( ( 1.0 - engLoadDelta1 )* engSpeedDelta1 *
            (int)angleTable[ i1 + ( numXEntries * ( j1 + 1 ) ) ] ) ) ;

      // printf("%d\n",outAngleValue1);
      outputArray[index++] = outAngleValue1;
  }//end of for

  char result[1000000];
  bzero(result, sizeof(result));
  int count = 0;
  for(int i=0; i<len; i++){
    char temp[20];
    sprintf(temp, "%d", outputArray[i]);
    for(int j=0; j<strlen(temp); j++){
      result[count] = temp[j];
      count++;
    }
    if(i<len-1){
      result[count]=',';
      count++;
    }
  }

  result[count]='A';

  int n = strlen(result);
  // printf("This length should be received %d \n",n);
  char sendi[60000];
  int send_index = 0;
  while(send_index < n){
    bzero(sendi, sizeof(sendi));
    for(int j=0; j<sizeof(send); j++){
      sendi[j] = result[send_index++];
      if(send_index == n) break;
    }
    send(sockfd, sendi, strlen(sendi), 0);
    if(send_index == n) break;
  }
  // close the socket
  close(sockfd);
}
